{% extends "base.html" %}

{% block title %}ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ - ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ {% endblock %}

{% block extra_css %}
<style>
    .import-container {
        max-width: 1000px;
        margin: 0 auto;
    }
    
    .import-section {
        background-color: white;
        padding: 2rem;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
    }
    
    .section-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 1.5rem;
        border-bottom: 2px solid #34495e;
        padding-bottom: 0.5rem;
    }
    
    .upload-area {
        border: 2px dashed #3498db;
        border-radius: 4px;
        padding: 2rem;
        text-align: center;
        background-color: #ecf0f1;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .upload-area:hover {
        background-color: #d5dbdb;
        border-color: #2980b9;
    }
    
    .upload-area input[type="file"] {
        display: none;
    }
    
    .upload-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    
    .upload-text {
        font-size: 1.1rem;
        color: #2c3e50;
        margin-bottom: 0.5rem;
    }
    
    .upload-hint {
        font-size: 0.9rem;
        color: #7f8c8d;
    }
    
    .template-list {
        margin-top: 2rem;
    }
    
    .template-item {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 1rem;
        margin-bottom: 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .template-info h4 {
        margin: 0 0 0.5rem 0;
        color: #2c3e50;
    }
    
    .template-info p {
        margin: 0;
        font-size: 0.9rem;
        color: #7f8c8d;
    }
    
    .template-actions {
        display: flex;
        gap: 0.5rem;
    }
    
    .btn-use {
        background-color: #27ae60;
        color: white;
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        font-size: 0.9rem;
    }
    
    .btn-use:hover {
        background-color: #229954;
    }
    
    .info-box {
        background-color: #d1ecf1;
        border: 1px solid #bee5eb;
        border-radius: 4px;
        padding: 1rem;
        margin-bottom: 1.5rem;
        color: #0c5460;
    }
    
    .info-box h4 {
        margin-top: 0;
    }
    
    .info-box ul {
        margin-bottom: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="import-container">
    <h2>ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
    
    <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="import-section">
        <h3 class="section-title">1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h3>
        
        <div class="info-box">
            <h4>å¯¾å¿œãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼</h4>
            <ul>
                <li><strong>CSV</strong>: ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«</li>
                <li><strong>Excel</strong>: .xlsx, .xlså½¢å¼</li>
            </ul>
        </div>
        
        <form method="POST" enctype="multipart/form-data">
            <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-text">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯</div>
                <div class="upload-hint">CSV ã¾ãŸã¯ Excel ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                <input type="file" id="fileInput" name="file" accept=".csv,.xlsx,.xls" required>
            </div>
            
            <button type="submit" class="btn btn-primary" style="margin-top: 1.5rem; width: 100%; padding: 0.75rem;">
                ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
            </button>
        </form>
    </div>
    
    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    {% if templates %}
    <div class="import-section">
        <h3 class="section-title">2. ä¿å­˜æ¸ˆã¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨</h3>
        
        <p style="color: #7f8c8d; margin-bottom: 1.5rem;">
            ä»¥å‰ã«è¨­å®šã—ãŸãƒãƒƒãƒ”ãƒ³ã‚°æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ã€ã™ãã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚
        </p>
        
        <div class="template-list">
            {% for template in templates %}
                <div class="template-item">
                    <div class="template-info">
                        <h4>{{ template.name }}</h4>
                        <p>ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼: {{ template.file_type | upper }} | ã‚¹ã‚­ãƒƒãƒ—è¡Œ: {{ template.skip_rows }}</p>
                    </div>
                    <div class="template-actions">
                        <a href="#" class="btn-use" onclick="useTemplate({{ template.id }}, '{{ template.name }}')">
                            ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
        
        <p style="text-align: center; margin-top: 1.5rem;">
            <a href="{{ url_for('import_data.import_templates_list') }}" class="btn btn-secondary">
                ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†
            </a>
        </p>
    </div>
    {% endif %}
    
    <!-- èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="import-section">
        <h3 class="section-title">ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®æµã‚Œ</h3>
        
        <ol style="line-height: 1.8;">
            <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</strong>: CSV ã¾ãŸã¯ Excel ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¾ã™</li>
            <li><strong>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º</strong>: ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
            <li><strong>ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®š</strong>: ã©ã®åˆ—ãŒã€Œå–å¼•æ—¥ã€ã€Œé‡‘é¡ã€ã‹ã‚’æŒ‡å®šã—ã¾ã™</li>
            <li><strong>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¿å­˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</strong>: ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šã‚’ä¿å­˜ã—ã¦ã€æ¬¡å›ä»¥é™ã¯è‡ªå‹•é©ç”¨ã§ãã¾ã™</li>
            <li><strong>ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ</strong>: å‡ºç´å¸³ã«ãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã¾ã™</li>
        </ol>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ
const uploadArea = document.querySelector('.upload-area');
const fileInput = document.getElementById('fileInput');

uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.style.backgroundColor = '#d5dbdb';
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.style.backgroundColor = '#ecf0f1';
});

uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        fileInput.files = files;
        // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¡¨ç¤º
        const fileName = files[0].name;
        console.log('Selected file:', fileName);
    }
});

function useTemplate(templateId, templateName) {
    alert('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ' + templateName + 'ã€ã‚’ä½¿ç”¨ã™ã‚‹æ©Ÿèƒ½ã¯å®Ÿè£…äºˆå®šã§ã™');
    // TODO: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’å®Ÿè¡Œ
}
</script>
{% endblock %}
